
*test-nestest: nestest.expected nestest.actual
  git diff --word-diff=color $ins | head -20

nestest.size: nestest.out
  echo $$(cat $< | wc -l) > $out

nestest.expected: nestest.golden nestest.size
  cat $in | head -$$(cat nestest.size) > $out

nestest.actual: nestest.out nestest.size # TODO jenga $in1 $in2
  cat nestest.out | head -$$(cat nestest.size) > $out

nestest.out : ../src/emu.exe nestest.nes
  ./$in nestest.nes --init-pc 0xC000 --trace-cpu --stop-at 14575 > $out || true
